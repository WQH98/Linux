###### 一、地址映射

1、裸机LED灯实验就是直接操作6ULL的寄存器。
2、Linux驱动开发也可以操作寄存器，Linux不能直接对寄存器物理地址进行读写操作，比如寄存器A的物理地址为0x01010101。裸机的时候可以直接对0x01010101这个物理地址进行操作，但是Linux下不行，因为Linux会使能MMU。（STM32不能跑Linux是因为没有MMU，在老版本的Linux中要求处理器必须有MMU，现在的Linux内核已经支持无MMU的处理器了。）MMU完成的主要功能一是完成虚拟空间到物理空间的映射，二是内存保护，设置存储器的访问权限，设置虚拟存储空间的缓冲特性。
3、因为在Linux里面操作的都是虚拟地址，所以需要先得到0x01010101这个物理地址所对应的虚拟地址。
4、Linux内核启动的时候会初始化MMU，设置好内存映射，设置好以后CPU访问的都是虚拟地址。
5、获得物理地址所对应的虚拟地址使用ioremap函数。第一个参数就是物理地址起始大小，第二个参数就是要转化的字节数量。va = ioremap(0x01010101, 10)代表的意思是从0x01010101开始的10个地址进行转换，va就是得到的虚拟地址。

```c
#define ioremap(cookie,size) __arm_ioremap((cookie), (size),  MT_DEVICE)
```

6、卸载驱动的时候，iounmap(va);

```c
void iounmap(volatile void __iomem *addr);
```

###### 二、LED灯字符设备驱动框架搭建

